%% $Id: setup.tex,v 1.11 2013/12/05 04:10:03 krisrose Exp $

%% Format.
\usepackage[utf8]{inputenc}
\usepackage{comment}
\usepackage{amsmath,amssymb,stmaryrd,textcomp}
\allowdisplaybreaks %style
\usepackage[normalem]{ulem}
\usepackage{pgfpages}
\usepackage{utf8math}
\usepackage{url}
\usepackage{xspace}
\usepackage{fancyvrb}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{rcs}

%% Macros.
\newcommand{\HAX}{\text{HACS}\xspace}
\newcommand{\CRSX}{\text{CRSX}\xspace}
\newcommand{\ie}{\textit{i.e.}\xspace}
\newcommand{\eg}{\textit{e.g.}\xspace}
\newcommand{\etc}{\textit{etc.}\xspace}
\newcommand{\aka}{\textit{aka.}\xspace}
\newcommand{\TBD}[1][]{\textit{To Be Done…#1}\marginpar{\bf\color{red} TBD}}

%% Misc.
\def\Bigstrut{\ensuremath{\vphantom{\Bigm|}}}
\newcommand\caret{\mathbin{\char`\^}}

%% Units
\ifx\theorem\undefined
  \usepackage{amsthm}
  \swapnumbers %style
  \newtheorem{theorem}{Theorem}[section]
  \newtheorem{lemma}[theorem]{Lemma}
  \theoremstyle{definition}
  \newtheorem{definition}[theorem]{Definition}
  \newtheorem{proposition}[theorem]{Proposition}
  \newtheorem{example}[theorem]{Example}
  \newtheorem{practice}[theorem]{Practice}
  \newtheorem{notation}[theorem]{Notation}
  \newtheorem{manual}[theorem]{Manual}
  %\newenvironment{manual}{\small\begin{manual-body}}{\end{manual-body}}
  \newtheorem{invariant}[theorem]{Invariant}
  \newtheorem{requirements}[theorem]{Requirements}
  \newtheorem{limitations}[theorem]{Limitations}
  \newtheorem{commands}[theorem]{Commands}
  \newtheorem{error}[theorem]{Error}
  \newtheorem{note}[theorem]{Note}
  \newtheorem{plan}[theorem]{Plan}
  %\theoremstyle{remark}
  \newtheorem{remark}[theorem]{Remark}
\fi

%% Old code listings.
\usepackage{alltt}
\usepackage{fancyvrb}
\CustomVerbatimEnvironment{code}{Verbatim}{tabsize=4,fontsize=\small,numberblanklines=false,xleftmargin=\parindent}
\CustomVerbatimCommand{\inputcode}{VerbatimInput}{tabsize=4,fontsize=\footnotesize,numbers=left,numberblanklines=false,xleftmargin=\parindent}
%\DefineShortVerb{\"} % makes " work in verbatim even when \active


%% New code listings...
\usepackage{listings}
\lstset{basicstyle=\ttfamily}

%% HACS.
\def\Identifier#1{#1}
\def\Keyword#1{\textsf{\color{gray}#1}}

\lstdefinelanguage{HACS}{basicstyle=\fontfamily{ccr}\selectfont,%
  extendedchars=true,inputencoding=utf8,sensitive,%
  identifierstyle=\Identifier,%
  string=[d]{"},morestring=[d]{'},upquote=true,showstringspaces=false,%
  comment=[l]{//},morecomment=[s]{/*}{*/},commentstyle=\color{blue}\rm,%
  keywordstyle=\Keyword,%
  keywords={attribute,data,fragment,import,main,module,nested,property,rule,scheme,simplify,sort,%
    space,static,sugar,symbol,tag,token,default,error,binds,as},%
  literate=%
    {⟦}{{\ensuremath{\llbracket}}}1 {⟧}{{\ensuremath{\rrbracket}}}1 {⟨}{{\ensuremath{\langle}}}1 {⟩}{{\ensuremath{\rangle}}}1 %
    {→}{{\ensuremath{\rightarrow}}}2 {↑}{{\ensuremath{\uparrow}}}1 {↓}{{\ensuremath{\downarrow}}}1 {¬}{{\ensuremath{\lnot}}}2 {¶}{{\P}}1 %
    {ε}{{\ensuremath{\varepsilon}}}1 {…}{{\ensuremath{\dots}}}2 {∧}{{\ensuremath{\!\wedge}}}2 {∨}{{\ensuremath{\!\vee}}}2 {↦}{{\ensuremath{\mapsto}}}2 %
}[comments,strings,keywords]
%%
\lstnewenvironment{hacs}[1][]{\lstset{language=HACS,basewidth={.53em,.43em},columns=flexible,numberstyle=\scriptsize,numberblanklines=false,firstnumber=auto,xrightmargin=1pc,#1}\upshape}{}
\newcommand\inputhacs[2][]{\lstinputlisting[language=HACS,basewidth={.53em,.43em},columns=flexible,numberstyle=\scriptstyle,numberblanklines=false,xrightmargin=1pc,#1]{#2}}
\newcommand\hacsc{\lstinline[language=HACS]}
\lstMakeShortInline[language=HACS,columns=fullflexible]"


%%% \usepackage{listings}
%%% 
%%% %% HACS.
%%% \lstdefinelanguage{HACS}{basicstyle=\rm,%
%%%   numberstyle=\scriptsize,
%%%   numbersep=7pt,
%%%   numberblanklines=false,
%%%   extendedchars=true,inputencoding=utf8,sensitive,%
%%%   identifierstyle=\textit,%
%%%   string=[d]{"},morestring=[m]{'},upquote=true,stringstyle=\ttfamily,%showstringspaces=true,%
%%%   comment=[l]{//},morecomment=[s]{/*}{*/},commentstyle=\color{gray}\upshape,%
%%%   keywordstyle=\color{black}\bfseries,%
%%%   keywords={attribute,data,default,fragment,import,main,module,nested,property,rule,scheme,simplify,sort,space,static,sugar,symbol,tag,token},%
%%%   ndkeywordstyle={\textup},%
%%%   literate=%
%%%     {⟦}{{\ensuremath{\llbracket}}}1 {⟧}{{\ensuremath{\rrbracket}}}1 {⟨}{{\ensuremath{\langle}}}1 {⟩}{{\ensuremath{\rangle}}}1 %
%%%     {→}{\ensuremath{\rightarrow}}2 {↑}{\ensuremath{\uparrow}}1 {↓}{\ensuremath{\downarrow}}1 {ε}{\ensuremath{\varepsilon}}1 %
%%%     {…}{\ensuremath{\dots}}2 {¬}{\ensuremath{\lnot}}1 {∧}{\ensuremath{\wedge}}2 {∨}{\ensuremath{\vee}}2 {¶}{\P}1 {↦}{\ensuremath{\mapsto}}2 %
%%% }[comments,strings,keywords]
%%% %%
%%% \lstnewenvironment{hacs}[1][]{\lstset{language=HACS,basewidth={.55em,.4em},columns=flexible,#1}\upshape}{}
%%% \newcommand\inputhacs[2][]{\lstinputlisting[language=HACS,basewidth={.55em,.4em},columns=flexible,#1]{#2}}
%%% \newcommand\hacsc{\lstinline[language=HACS]}
%%% \lstMakeShortInline[language=HACS,columns=fullflexible]"
%%% 
%%% %% Tiger.
%%% \lstdefinelanguage{Tiger}{basicstyle=\normalsize,%
%%%   extendedchars=true,inputencoding=utf8,sensitive,%
%%%   identifierstyle=\textit,%
%%%   string=[d]{"},upquote=true,stringstyle=\ttfamily,showstringspaces=true,%
%%%   comment=[s]{/*}{*/},commentstyle=\color{grey}\rm,%
%%%   keywordstyle=\color{black}\bfseries,%
%%%   keywords={type,array,of,var,function,nil,let,in,end}%
%%% }[comments,strings,keywords]
%%% %%
%%% \lstnewenvironment{tiger}[1][]{\lstset{language=Tiger,basewidth={.5em,.4em},columns=flexible,#1}\upshape}{}
%%% \newcommand\inputtiger[2][]{\lstinputlisting[language=Tiger,basewidth={.5em,.4em},columns=flexible,#1]{#2}}
%%% \newcommand\tigerc{\lstinline[language=Tiger]}

%% Identifiers
\newcommand{\set}[1]{\textit{#1}}
\newcommand{\op}[1]{\ensuremath{\operatorname{#1}}}

\usepackage[all]{xy}
\SelectTips{eu}{}

\makeatletter
\def\compacttableofcontents{{\if@twocolumn\else \quotation\small \fi
    \noindent\textbf{Contents:}~%
    \def\protect{\relax}%
    \def\contentsline##1{\csname contentslineA##1\endcsname}%
    \def\numberline##1{\DN@{##1}\ifx\next@\empty\else##1.~\fi}%
    \def\fresh##1{\relax \let\fresh=\nextfresh}%
    \def\nextfresh##1{\relax##1 }%
    \def\contentslineAsection##1##2##3{\fresh,##1~(##2)\ignorespaces}%
    \def\contentslineAsubsection##1##2##3{\ignorespaces}%
    \@starttoc{toc}.\endquotation}}
\makeatother
